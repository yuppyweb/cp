version: '3'

tasks:
  build-unix:
    cmds:
      - go build -v -o bin/cp ./cp.go
    desc: Build the cp binary for Unix-like systems

  build-win:
    cmds:
      - GOOS=windows GOARCH=amd64 go build -v -o bin/cp.exe ./cp.go
    desc: Build the cp binary for Windows

  fix:
    cmds:
      - golangci-lint run --fix --color=always 
    desc: Automatically fix linting issues

  lint:
    cmds:
      - golangci-lint run --color=always
    desc: Run golangci-lint on the codebase

  test:
    cmds:
      - go test --count=1 -v -coverprofile cover.out ./...
      - go tool cover -html cover.out -o cover.html
      - go tool cover -func cover.out
      - rm cover.out
    desc: Run tests with coverage
    ignore_error: true

  vuln:
    cmds:
      - govulncheck -show=color -test ./...
    desc: Run Go vulnerability checker
    